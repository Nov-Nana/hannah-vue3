import{c6 as y}from"./index-d769c587.js";import{X as d}from"./xlsx-4e46f303.js";var A={exports:{}};(function(v,h){(function(f,o){o()})(y,function(){function f(e,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function o(e,t,i){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,t,i)},n.onerror=function(){console.error("could not download file")},n.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof y=="object"&&y.global===y?y:void 0,p=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!p?function(e,t,i){var n=r.URL||r.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener",typeof e=="string"?(c.href=e,c.origin===location.origin?a(c):s(c.href)?o(e,t,i):a(c,c.target="_blank")):(c.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(c.href)},4e4),setTimeout(function(){a(c)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,i){if(t=t||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(f(e,i),t);else if(s(e))o(e,t,i);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){a(n)})}}:function(e,t,i,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return o(e,t,i);var c=e.type==="application/octet-stream",u=/constructor/i.test(r.HTMLElement)||r.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||c&&u||p)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var m=g.result;m=w?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=m:location=m,n=null},g.readAsDataURL(e)}else{var x=r.URL||r.webkitURL,S=x.createObjectURL(e);n?n.location=S:location.href=S,n=null,setTimeout(function(){x.revokeObjectURL(S)},4e4)}});r.saveAs=l.saveAs=l,v.exports=l})})(A);var _=A.exports;function T(v){for(var h=[],f=v.querySelectorAll("tr"),o=[],s=0;s<f.length;++s){for(var a=[],r=f[s],p=r.querySelectorAll("td"),l=0;l<p.length;++l){var e=p[l],t=e.getAttribute("colspan"),i=e.getAttribute("rowspan"),n=e.innerText;if(n!==""&&n==+n&&(n=+n),o.forEach(function(u){if(s>=u.s.r&&s<=u.e.r&&a.length>=u.s.c&&a.length<=u.e.c)for(var w=0;w<=u.e.c-u.s.c;++w)a.push(null)}),(i||t)&&(i=i||1,t=t||1,o.push({s:{r:s,c:a.length},e:{r:s+i-1,c:a.length+t-1}})),a.push(n!==""?n:null),t)for(var c=0;c<t-1;++c)a.push(null)}h.push(a)}return[h,o]}function L(v,h){h&&(v+=1462);var f=Date.parse(v);return(f-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function E(v,h){for(var f={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},s=0;s!=v.length;++s)for(var a=0;a!=v[s].length;++a){o.s.r>s&&(o.s.r=s),o.s.c>a&&(o.s.c=a),o.e.r<s&&(o.e.r=s),o.e.c<a&&(o.e.c=a);var r={v:v[s][a]};if(r.v!=null){var p=d.utils.encode_cell({c:a,r:s});typeof r.v=="number"?r.t="n":typeof r.v=="boolean"?r.t="b":r.v instanceof Date?(r.t="n",r.z=d.SSF._table[14],r.v=L(r.v)):r.t="s",f[p]=r}}return o.s.c<1e7&&(f["!ref"]=d.utils.encode_range(o)),f}function b(){if(!(this instanceof b))return new b;this.SheetNames=[],this.Sheets={}}function j(v){for(var h=new ArrayBuffer(v.length),f=new Uint8Array(h),o=0;o!=v.length;++o)f[o]=v.charCodeAt(o)&255;return h}function B(v){var h=document.getElementById(v),f=T(h),o=f[1],s=f[0],a="SheetJS",r=new b,p=E(s);p["!merges"]=o,r.SheetNames.push(a),r.Sheets[a]=p;var l=d.write(r,{bookType:"xlsx",bookSST:!1,type:"binary"});_.saveAs(new Blob([j(l)],{type:"application/octet-stream"}),"test.xlsx")}function F({multiHeader:v=[],header:h,data:f,filename:o,merges:s=[],autoWidth:a=!0,bookType:r="xlsx"}={}){o=o||"excel-list",f=[...f],f.unshift(h);for(let i=v.length-1;i>-1;i--)f.unshift(v[i]);var p="SheetJS",l=new b,e=E(f);if(s.length>0&&(e["!merges"]||(e["!merges"]=[]),s.forEach(i=>{e["!merges"].push(d.utils.decode_range(i))})),a){const i=f.map(c=>c.map(u=>u==null?{wch:10}:u.toString().charCodeAt(0)>255?{wch:u.toString().length*2}:{wch:u.toString().length}));let n=i[0];for(let c=1;c<i.length;c++)for(let u=0;u<i[c].length;u++)n[u].wch<i[c][u].wch&&(n[u].wch=i[c][u].wch);e["!cols"]=n}l.SheetNames.push(p),l.Sheets[p]=e;var t=d.write(l,{bookType:r,bookSST:!1,type:"binary"});_.saveAs(new Blob([j(t)],{type:"application/octet-stream"}),`${o}.${r}`)}export{F as export_json_to_excel,B as export_table_to_excel};
